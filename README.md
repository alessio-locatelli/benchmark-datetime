# benchmark-datetime

Compare:

- [python-dateutil](https://github.com/dateutil/dateutil)
- [arrow](https://github.com/arrow-py/arrow/)
- [pendulum](https://github.com/sdispater/pendulum)
- [udatetime](https://github.com/freach/udatetime)
- Python built-in [`datetime`](https://docs.python.org/3/library/datetime.html)
- [pydantic](https://github.com/pydantic/pydantic)

## How to setup

1. Install [Poetry](https://python-poetry.org/).
2. Activate the virtual environment and install dependencies: `poetry shell && poetry install`.

Some packages (for example, `udatetime`) may require additional dependencies for building from source.
Read the documentation for specific packages if the installation fails.

## How to run

```sh
pytest benchmark_datetime/benchmark.py --benchmark-group-by=func
```

## Results summary

If performance is important:

- Use Python `datetime` module for manipulating dates and times.
- Use Python `datetime` module, `udatetime`, `Pydantic` for parsing.

## Results

```bash
===================================================================================== test session starts =====================================================================================
platform linux -- Python 3.11.6, pytest-7.4.3, pluggy-1.3.0
benchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /home/sam/projects/benchmark-datetime
plugins: benchmark-4.0.0, Faker-20.1.0
collected 31 items

benchmark_datetime/benchmark.py ...............................                                                                                                                         [100%]


------------------------------------------------------------------------------ benchmark 'test_add_timedelta': 4 tests ------------------------------------------------------------------------------
Name (time in us)                    Min                Max               Mean            StdDev             Median               IQR            Outliers  OPS (Kops/s)            Rounds  Iterations
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_add_timedelta[python]        1.5650 (1.0)      26.9710 (1.0)       1.7428 (1.0)      0.5861 (1.0)       1.6810 (1.0)      0.0540 (1.0)     3025;7397      573.7927 (1.0)      183622           1
test_add_timedelta[dateutil]     10.3880 (6.64)     76.3790 (2.83)     11.2108 (6.43)     2.0251 (3.46)     10.7390 (6.39)     0.2980 (5.52)    3101;3972       89.1999 (0.16)      55692           1
test_add_timedelta[pendulum]     17.1820 (10.98)    66.7750 (2.48)     18.4503 (10.59)    3.0974 (5.28)     17.8075 (10.59)    0.4820 (8.93)     799;1082       54.1996 (0.09)      16082           1
test_add_timedelta[arrow]        20.0430 (12.81)    79.2870 (2.94)     21.3225 (12.23)    3.3607 (5.73)     20.5370 (12.22)    0.5670 (10.51)    801;1035       46.8987 (0.08)      14780           1
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------- benchmark 'test_now': 3 tests -------------------------------------------------------------------------------------------
Name (time in ns)               Min                     Max                   Mean                StdDev                 Median                   IQR            Outliers  OPS (Kops/s)            Rounds  Iterations
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_now[udatetime]        178.7311 (1.0)        1,818.7308 (1.0)         190.6484 (1.0)         43.9088 (1.0)         185.3847 (1.0)          5.2309 (1.0)     4555;5518    5,245.2566 (1.0)      195925          26
test_now[python]           393.3499 (2.20)       3,865.6508 (2.13)        421.6732 (2.21)        91.8207 (2.09)        405.0511 (2.18)        10.7510 (2.06)    6587;6995    2,371.5046 (0.45)     120512          20
test_now[arrow]         49,099.0060 (274.71)   169,413.0187 (93.15)    52,958.5594 (277.78)   8,270.2773 (188.35)   50,539.9948 (272.62)   1,548.0036 (295.94)   669;1306       18.8827 (0.00)       9761           1
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

---------------------------------------------------------------------------------------- benchmark 'test_now_utc': 5 tests ----------------------------------------------------------------------------------------
Name (time in ns)                  Min                    Max                  Mean                StdDev                Median                 IQR            Outliers  OPS (Kops/s)            Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_now_utc[udatetime]       175.8518 (1.0)       2,220.5554 (1.0)        194.8936 (1.0)         58.6999 (1.0)        182.5554 (1.0)        5.0371 (1.0)    11708;12765    5,131.0043 (1.0)      195925          27
test_now_utc[python]          366.6501 (2.08)     13,155.1002 (5.92)       390.7845 (2.01)        97.6263 (1.66)       375.4496 (2.06)      10.1005 (2.01)    4346;4924    2,558.9551 (0.50)     128634          20
test_now_utc[dateutil]        468.2501 (2.66)     13,140.8000 (5.92)       512.4808 (2.63)       118.6576 (2.02)       492.3495 (2.70)      15.2490 (3.03)    3552;4055    1,951.2925 (0.38)      93607          20
test_now_utc[arrow]         3,451.9762 (19.63)    31,539.9957 (14.20)    3,768.5273 (19.34)    1,013.6246 (17.27)    3,627.0067 (19.87)    111.0311 (22.04)    769;1243      265.3556 (0.05)      31893           1
test_now_utc[pendulum]      8,136.9944 (46.27)    80,814.9925 (36.39)    9,171.5120 (47.06)    2,630.9192 (44.82)    8,592.0037 (47.07)    271.2550 (53.85)   1270;1644      109.0333 (0.02)      19333           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------- benchmark 'test_parse_utc_from_iso_8601': 5 tests --------------------------------------------------------------------------------------------
Name (time in ns)                                   Min                     Max                   Mean                 StdDev                 Median                   IQR            Outliers  OPS (Kops/s)            Rounds  Iterations
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_parse_utc_from_iso_8601[python]           136.7700 (1.0)          863.5400 (1.0)         147.1026 (1.0)          28.8144 (1.0)         141.2400 (1.0)          3.9200 (1.0)     3980;4938    6,797.9787 (1.0)       68852         100
test_parse_utc_from_iso_8601[pydantic]         866.0136 (6.33)      19,295.0247 (22.34)     1,022.4543 (6.95)        464.1232 (16.11)       973.9888 (6.90)        44.9945 (11.48)   1531;3382      978.0388 (0.14)      75586           1
test_parse_utc_from_iso_8601[udatetime]      1,223.0012 (8.94)      19,391.0091 (22.46)     1,354.2087 (9.21)        526.7102 (18.28)     1,307.9843 (9.26)        41.0073 (10.46)   1066;4155      738.4386 (0.11)     102723           1
test_parse_utc_from_iso_8601[pendulum]      20,128.0054 (147.17)    66,683.0165 (77.22)    22,115.6001 (150.34)    4,125.8074 (143.19)   21,020.9982 (148.83)     667.0016 (170.15)  1345;1805       45.2170 (0.01)      17436           1
test_parse_utc_from_iso_8601[arrow]         74,325.0130 (543.43)   187,075.9879 (216.64)   81,125.8331 (551.49)   12,817.5439 (444.83)   77,733.0133 (550.36)   2,458.2259 (627.10)       8;25       12.3265 (0.00)        125           1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-------------------------------------------------------------------------------------------- benchmark 'test_parse_utc_from_rfc_3339': 5 tests --------------------------------------------------------------------------------------------
Name (time in ns)                                   Min                     Max                   Mean                 StdDev                 Median                   IQR             Outliers  OPS (Kops/s)            Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_parse_utc_from_rfc_3339[python]           182.9588 (1.0)        1,473.5415 (1.0)         192.0380 (1.0)          40.3351 (1.0)         186.0414 (1.0)          4.9173 (1.0)      1252;1597    5,207.3024 (1.0)       72338          24
test_parse_utc_from_rfc_3339[pydantic]         883.9997 (4.83)      17,145.9978 (11.64)     1,067.9096 (5.56)        522.4304 (12.95)       970.0016 (5.21)        46.0132 (9.36)     5287;6890      936.4089 (0.18)      77304           1
test_parse_utc_from_rfc_3339[udatetime]      1,239.9978 (6.78)      24,843.9901 (16.86)     1,384.2111 (7.21)        585.2027 (14.51)     1,309.0030 (7.04)        42.9864 (8.74)     2596;5103      722.4331 (0.14)      90507           1
test_parse_utc_from_rfc_3339[pendulum]      20,758.0160 (113.46)    76,182.9724 (51.70)    23,242.1210 (121.03)    4,737.8376 (117.46)   21,842.9777 (117.41)     628.0097 (127.71)   1347;1794       43.0253 (0.01)      14461           1
test_parse_utc_from_rfc_3339[arrow]         73,355.0114 (400.94)   186,905.0029 (126.84)   78,536.8336 (408.97)   10,774.2582 (267.12)   75,835.0070 (407.62)   2,307.4972 (469.26)     391;898       12.7329 (0.00)       5500           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------- benchmark 'test_parse_utc_from_timestamp': 5 tests ----------------------------------------------------------------------------------------
Name (time in ns)                                   Min                     Max                  Mean                StdDev                Median                 IQR            Outliers  OPS (Kops/s)            Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_parse_utc_from_timestamp[python]          161.5600 (1.0)          726.6100 (1.0)        176.5124 (1.0)         40.1008 (1.0)        167.5601 (1.0)        4.5300 (1.0)     3405;4308    5,665.3242 (1.0)       57931         100
test_parse_utc_from_timestamp[udatetime]       189.0399 (1.17)       1,464.3604 (2.02)       200.6073 (1.14)        43.6484 (1.09)       193.4392 (1.15)       5.1211 (1.13)    4510;5491    4,984.8628 (0.88)     196347          25
test_parse_utc_from_timestamp[pydantic]      2,032.0003 (12.58)     32,267.9989 (44.41)    2,233.1115 (12.65)      780.3839 (19.46)    2,160.9885 (12.90)     64.0284 (14.13)    379;1319      447.8057 (0.08)      36289           1
test_parse_utc_from_timestamp[pendulum]      4,332.0179 (26.81)    102,869.0021 (141.57)   4,704.7271 (26.65)    1,149.6539 (28.67)    4,558.0091 (27.20)    125.0010 (27.59)   1261;2295      212.5522 (0.04)      54888           1
test_parse_utc_from_timestamp[arrow]         5,756.9996 (35.63)     41,166.9898 (56.66)    6,258.3900 (35.46)    1,343.6825 (33.51)    6,043.0029 (36.06)    173.9900 (38.41)    871;1283      159.7855 (0.03)      26209           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------ benchmark 'test_substract_timedelta': 4 tests -------------------------------------------------------------------------------
Name (time in us)                          Min                Max               Mean            StdDev             Median               IQR             Outliers  OPS (Kops/s)            Rounds  Iterations
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_substract_timedelta[python]        1.6160 (1.0)      33.4300 (1.0)       1.7785 (1.0)      0.5969 (1.0)       1.7160 (1.0)      0.0560 (1.0)      2647;6388      562.2839 (1.0)      161135           1
test_substract_timedelta[dateutil]     10.5220 (6.51)     49.5190 (1.48)     11.4242 (6.42)     2.0008 (3.35)     11.0080 (6.41)     0.3530 (6.30)     2301;2878       87.5333 (0.16)      49332           1
test_substract_timedelta[pendulum]     17.0860 (10.57)    77.7250 (2.33)     19.7112 (11.08)    4.3417 (7.27)     18.0700 (10.53)    0.6230 (11.12)    2600;3049       50.7327 (0.09)      19386           1
test_substract_timedelta[arrow]        20.0790 (12.43)    75.1960 (2.25)     21.7011 (12.20)    3.2238 (5.40)     20.9650 (12.22)    0.5920 (10.57)    1405;1696       46.0806 (0.08)      20004           1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Legend:
  Outliers: 1 Standard Deviation from Mean; 1.5 IQR (InterQuartile Range) from 1st Quartile and 3rd Quartile.
  OPS: Operations Per Second, computed as 1 / Mean
```
